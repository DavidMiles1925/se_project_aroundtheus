!function(){"use strict";var e=class{constructor(e,t){this._settings=e,this._formElement=t}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.setAttribute("disabled",!0),this._buttonElement.classList.add(this._settings.inactiveButtonClass)):(this._buttonElement.removeAttribute("disabled"),this._buttonElement.classList.remove(this._settings.inactiveButtonClass))}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._settings.inputErrorClass),s.textContent=t,s.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._fieldsetElement.querySelector(`.${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_handleInputChange(e){this._checkInputValidity(e),this._toggleButtonState()}_setEventListeners(){this._inputList=[...this._fieldsetElement.querySelectorAll(this._settings.inputSelector)],this._buttonElement=this._fieldsetElement.querySelector(this._settings.submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>this._handleInputChange(e)))}))}enableValidation(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._fieldsetElement=this._formElement.querySelector(this._settings.formFieldsetSelector),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}};const t={formSelector:".form",formFieldsetSelector:".form__fieldset",inputSelector:".form__input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"form__submit-button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"};const s=document.querySelector(".body");var r=class{constructor(e){this._popupElement=e,this._closeButton=this._popupElement.querySelector(".modal__close-button"),this._handleEscCloseBound=this._handleEscClose.bind(this),this._handleRemoteClickCloseBound=this._handleRemoteClickClose.bind(this),this._closePopupBound=this.close.bind(this)}open(){s.classList.remove("preload"),this._popupElement.classList.add("modal_open"),this._setEventListeners()}close(){this._popupElement.classList.remove("modal_open"),this._removeEventListeners()}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleRemoteClickClose(e){e.target===e.currentTarget&&this.close()}_setEventListeners(){document.addEventListener("keydown",this._handleEscCloseBound),this._popupElement.addEventListener("mousedown",this._handleRemoteClickCloseBound),this._closeButton.addEventListener("click",this._closePopupBound)}_removeEventListeners(){document.removeEventListener("keydown",this._handleEscCloseBound),this._popupElement.removeEventListener("mousedown",this._handleRemoteClickCloseBound),this._closeButton.removeEventListener("click",this._closePopupBound)}};var i=class extends r{constructor(e,t){var s,r,i;super(e),s=this,i=e=>{e.preventDefault();const t=this._getInputValues();this._onSubmit(t)},(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(r="_handleSubmit"))in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i,this._onSubmit=t,this._formSelector=this._popupElement.querySelector(".form"),this._submitButton=this._popupElement.querySelector(".form__submit-button"),this.currentButtonText=this._submitButton.textContent}_getInputValues(){const e=[...this._formSelector.querySelectorAll(".form__input")],t={};return e.forEach((e=>{t[e.name]=e.value})),t}_setEventListeners(){super._setEventListeners(),this._formSelector.addEventListener("submit",this._handleSubmit)}_removeEventListeners(){super._removeEventListeners(),this._formSelector.removeEventListener("submit",this._handleSubmit)}close(){super.close(),this._popupElement.querySelector(".form").reset()}toggleIsSaving(e){this._submitButton.textContent=e?"Saving...":this.currentButtonText}};const n=document.querySelector(".modal_profile"),o=document.querySelector(".modal_add-card"),a=document.querySelector(".modal_profile-picture"),l=document.querySelector(".modal_display-image"),h=document.querySelector(".modal_confirm"),c=n.querySelector(".form"),u=o.querySelector(".form"),d=a.querySelector(".form"),_=document.querySelector(".profile"),m=_.querySelector(".profile__edit-button"),p=_.querySelector(".profile__add-button"),v=_.querySelector(".profile__image-button"),f=(_.querySelector(".profile__image"),n.querySelector(".form__input_type_name")),g=n.querySelector(".form__input_type_about");let S;const E=new class{constructor(e,t){var s,r,i;s=this,i=e=>e.ok?e.json():(console.log(`Error: ${e.status}`),Promise.reject(`Error: ${e.status}`)),(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(r="_processServerResponse"))in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i,this._baseURL=e,this._authToken=t,this._headers={authorization:t,"Content-Type":"application/json"}}getInitialCards(){return fetch(`${this._baseURL}/cards`,{method:"GET",headers:this._headers}).then(this._processServerResponse)}getUserInfo(){return fetch(`${this._baseURL}/users/me`,{method:"GET",headers:this._headers}).then(this._processServerResponse)}getApiInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}setUserInfo(e){fetch(`${this._baseURL}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})})}setAvatar(e){fetch(`${this._baseURL}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}addCard(e){return fetch(`${this._baseURL}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link,likes:e.likes})}).then(this._processServerResponse)}deleteCard(e){return fetch(`${this._baseURL}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._processServerResponse)}addLike(e){return fetch(`${this._baseURL}/cards/likes/${e}`,{method:"PUT",headers:this._headers}).then(this._processServerResponse)}removeLike(e){return fetch(`${this._baseURL}/cards/likes/${e}`,{method:"DELETE",headers:this._headers}).then(this._processServerResponse)}}("https://around.nomoreparties.co/v1/group-12","cd0a9a45-f29d-487c-ac51-4b9d290460ac"),b=new class{constructor(e,t){this._renderer=e,this._cardsDisplayed=document.querySelector(t)}renderItems(e){e.forEach((e=>{const t=this._renderer(e);this._cardsDisplayed.append(t)}))}addItem(e){const t=this._renderer(e);this._cardsDisplayed.prepend(t)}}((function(e){return new class{constructor(e,t,s,r,i,n){this._name=e.name,this._link=e.link,this._alt=e.name,this._likes=e.likes,this._id=e._id,this._ownerId=e.owner._id,this._userId=n,this._cardSelector=t,this._handleLike=s,this._handleImageClick=r,this._deleteServerCard=i}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getCardElement(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._cardText=this._element.querySelector(".card__title"),this._cardLikes=this._element.querySelector(".card__likes"),this._cardText.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._alt,this._cardLikes.textContent=this._likes.length,this._heartButton=this._element.querySelector(".card__like-button"),this._deleteButton=this._element.querySelector(".card__delete-button"),this._imageButton=this._element.querySelector(".card__image"),this._assignCardButtons(),this._ownerId!==this._userId&&this._deleteButton.remove(),this._renderLikes(),this._element}_assignCardButtons(){this._heartButton.addEventListener("click",(()=>this._handleLike(this))),this._deleteButton.addEventListener("click",(()=>this._deleteServerCard(this))),this._imageButton.addEventListener("click",(()=>this._handleImageClick(this._name,this._link)))}isLiked(){return this._likes.some((e=>this._userId===e._id))}updateLikes(e){this._likes=e,this._renderLikes()}_renderLikes(){this.isLiked()?this._heartButton.classList.add("card_liked"):this._heartButton.classList.remove("card_liked"),this._cardLikes.textContent=this._likes.length}handleDeleteLocalCard(){this._element.remove(),this._element=null}}(e,"#card",x,$,U,S).getCardElement()}),".cards"),y=new class{constructor(e,t,s){this._name=document.querySelector(e),this._about=document.querySelector(t),this._picture=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e,t){this._name.textContent=e,this._about.textContent=t}setProfilePicture(e){this._picture.src=e}}(".profile__title",".profile__description",".profile__image"),L=new class extends r{constructor(e){super(e),this._image=this._popupElement.querySelector(".modal__image"),this._modalImageDescription=this._popupElement.querySelector(".modal__image-desctription")}open(e,t){super.open(),this._image.alt=e,this._image.src=t,this._modalImageDescription.textContent=e}}(l,R),k=new i(n,(function(e){k.toggleIsSaving(!0),Promise.resolve(E.setUserInfo(e)).then((()=>{y.setUserInfo(e.name,e.about)})).catch((e=>Promise.reject(`Error: ${e.status}`))).finally((()=>{k.toggleIsSaving(!1),k.close()}))})),C=new i(o,(function(e){C.toggleIsSaving(!0),E.addCard(e).then((e=>{b.addItem(e)})).catch((e=>Promise.reject(`Error: ${e.status}`))).finally((()=>{C.toggleIsSaving(!1),C.close()}))})),I=new i(a,R),q=new class extends r{constructor(e){super(e),this._formSelector=this._popupElement.querySelector(".form")}setEventListeners(){super._setEventListeners(),this._formSelector.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}setSubmit(e){this._handleSubmit=e}}(h);q.setEventListeners();const B=new e(t,c),P=new e(t,u),w=new e(t,d);function R(e){I.toggleIsSaving(!0),Promise.resolve(E.setAvatar(e.avatar)).then((()=>{y.setProfilePicture(e.avatar)})).catch((e=>Promise.reject(`Error: ${err.status}`))).finally((()=>{I.toggleIsSaving(!1),I.close()}))}function $(e,t){L.open(e,t)}function U(e){q.open(),q.setSubmit((()=>{Promise.resolve(E.deleteCard(e._id)).then((()=>{e.handleDeleteLocalCard()})).then((()=>{q.close()})).catch((e=>Promise.reject(`Error: ${e.status}`)))}))}function x(e){e.isLiked()?Promise.resolve(E.removeLike(e._id)).then((t=>e.updateLikes(t.likes))).catch((e=>Promise.reject(`Error: ${e.status}`))):Promise.resolve(E.addLike(e._id)).then((t=>e.updateLikes(t.likes))).catch((e=>Promise.reject(`Error: ${e.status}`)))}B.enableValidation(),P.enableValidation(),w.enableValidation(),Promise.all([E.getUserInfo(),E.getInitialCards()]).then((e=>{let[t,s]=e;S=t._id,y.setProfilePicture(t.avatar),y.setUserInfo(t.name,t.about),b.renderItems(s)})).catch((e=>{console.log(e)})),m.addEventListener("click",(function(){!function(){const e=y.getUserInfo();f.value=e.name,g.value=e.about}(),k.open(),B.resetValidation()})),p.addEventListener("click",(function(){C.open(),P.resetValidation()})),v.addEventListener("click",(function(){I.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixJQUEzQitGLEVBQVVDLEdBQVksRUFDNUJwSCxFQUFTbUgsRUFBU3pELElBQ2xCK0IsRUFBV0ksa0JBQWtCc0IsRUFBU25GLFFBQ3RDeUQsRUFBV2hFLFlBQVkwRixFQUFTdkksS0FBTXVJLEVBQVNyRixPQUMvQ1MsRUFBWUssWUFBWXdFLEVBQVksSUFFckNmLE9BQU9DLElBQ04vRixRQUFRQyxJQUFJOEYsRUFBSSxJQWJsQjNHLEVBQVd0RCxpQkFBaUIsU0E5RzlCLFlBTkEsV0FDRSxNQUFNZ0wsRUFBVzVCLEVBQVduRSxjQUM1QnhCLEVBQWFqQixNQUFRd0ksRUFBU3pJLEtBQzlCbUIsRUFBY2xCLE1BQVF3SSxFQUFTdkYsS0FDakMsQ0FHRXdGLEdBQ0FwQixFQUFTekksT0FDVHFKLEVBQWtCcEssaUJBQ3BCLElBMkdFa0QsRUFBVXZELGlCQUFpQixTQXpHN0IsV0FDRW1LLEVBQVEvSSxPQUNSdUosRUFBaUJ0SyxpQkFDbkIsSUF1R0VtRCxFQUFjeEQsaUJBQWlCLFNBckdqQyxXQUNFcUssRUFBWWpKLE1BQ2QsRyIsInNvdXJjZXMiOlsid2VicGFjazovL0Fyb3VuZCB0aGUgVS5TLi8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVLlMuLy4vc3JjL2NvbnN0YW50cy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVLlMuLy4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVS5TLi8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVS5TLi8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVLlMuLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVS5TLi8uL3NyYy91dGlscy9BUEkuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVLlMuLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFUuUy4vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVS5TLi8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVS5TLi8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVS5TLi8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRMaXN0KSkge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2ZpZWxkc2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUlucHV0Q2hhbmdlKGlucHV0RWxlbWVudCkge1xyXG4gICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gW1xyXG4gICAgICAuLi50aGlzLl9maWVsZHNldEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSxcclxuICAgIF07XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZmllbGRzZXRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+XHJcbiAgICAgICAgdGhpcy5faGFuZGxlSW5wdXRDaGFuZ2UoaW5wdXRFbGVtZW50KVxyXG4gICAgICApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fZmllbGRzZXRFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc2V0dGluZ3MuZm9ybUZpZWxkc2V0U2VsZWN0b3JcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG4iLCJjb25zdCBhdXRoVG9rZW4gPSBcImNkMGE5YTQ1LWYyOWQtNDg3Yy1hYzUxLTRiOWQyOTA0NjBhY1wiO1xyXG5jb25zdCBiYXNlVVJMID0gXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCI7XHJcblxyXG5jb25zdCBkYXZpZEltYWdlID0gbmV3IFVSTChcIi4uL2ltYWdlcy9kYXZpZC5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcclxuXHJcbmNvbnN0IGNhcmRzRGlzcGxheWVkID0gXCIuY2FyZHNcIjtcclxuXHJcbmNvbnN0IGNvbmZpZ1ZhbGlkYXRlID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIuZm9ybVwiLFxyXG4gIGZvcm1GaWVsZHNldFNlbGVjdG9yOiBcIi5mb3JtX19maWVsZHNldFwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX3N1Ym1pdC1idXR0b25faW5hY3RpdmVcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwiZm9ybV9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG5cclxuY29uc3QgY29uZmlnQ2xvc2UgPSB7XHJcbiAgY2xvc2VCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiLFxyXG4gIG1vZGFsT3ZlcmxheVNlbGVjdG9yOiBcIi5tb2RhbFwiLFxyXG4gIG1vZGFsQ29udGFpbmVyTGlzdDogXCIubW9kYWxfX2NvbnRhaW5lclwiLFxyXG59O1xyXG5cclxuY29uc3QgY29uZmlnVXNlciA9IHtcclxuICB1c2VyTW9kYWw6IFwiLm1vZGFsX3Byb2ZpbGVcIixcclxuICBjdXJyZW50TmFtZTogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBjdXJyZW50QWJvdXQ6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbiAgbmV3TmFtZTogXCIuZm9ybV9faW5wdXRfdHlwZV9uYW1lXCIsXHJcbiAgbmV3QWJvdXQ6IFwiLmZvcm1fX2lucHV0X3R5cGVfYWJvdXRcIixcclxuICBwcm9maWxlUGljdHVyZTogXCIucHJvZmlsZV9faW1hZ2VcIixcclxufTtcclxuXHJcbi8qY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiQm91bGRlciwgQ09cIixcclxuICAgIGxpbms6IGJvdWxkZXJJbWFnZSxcclxuICAgIGxpa2VzOiBbXSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiRG9oZW55IEJlYWNoLCBDQVwiLFxyXG4gICAgbGluazogZG9oZW55SW1hZ2UsXHJcbiAgICBsaWtlczogW10sXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkV1cmVrYSBTcHJpbmdzLCBBS1wiLFxyXG4gICAgbGluazogZXVyZWthSW1hZ2UsXHJcbiAgICBsaWtlczogW10sXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkZvcnQgTGF1ZGVyZGFsZSwgRkxcIixcclxuICAgIGxpbms6IGxhdWRlcmRhbGVJbWFnZSxcclxuICAgIGxpa2VzOiBbXSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTWVsdmVybiBMYWtlLCBLU1wiLFxyXG4gICAgbGluazogbWVsdmVybkltYWdlLFxyXG4gICAgbGlrZXM6IFtdLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJSb3lhbCBHb3JnZSwgQ09cIixcclxuICAgIGxpbms6IHJveWFsSW1hZ2UsXHJcbiAgICBsaWtlczogW10sXHJcbiAgfSxcclxuXTsqL1xyXG5cclxuZXhwb3J0IHtcclxuICBjYXJkc0Rpc3BsYXllZCxcclxuICBjb25maWdWYWxpZGF0ZSxcclxuICBjb25maWdDbG9zZSxcclxuICBjb25maWdVc2VyLFxyXG4gIGF1dGhUb2tlbixcclxuICBiYXNlVVJMLFxyXG59O1xyXG4iLCJjb25zdCBib2R5RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYm9keVwiKTtcclxuXHJcbmZ1bmN0aW9uIHJlbW92ZVByZWxvYWQoKSB7XHJcbiAgYm9keUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInByZWxvYWRcIik7XHJcbn1cclxuXHJcbmV4cG9ydCB7IHJlbW92ZVByZWxvYWQgfTtcclxuIiwiaW1wb3J0IHsgcmVtb3ZlUHJlbG9hZCB9IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IHBvcHVwU2VsZWN0b3I7XHJcblxyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlQm91bmQgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5faGFuZGxlUmVtb3RlQ2xpY2tDbG9zZUJvdW5kID0gdGhpcy5faGFuZGxlUmVtb3RlQ2xpY2tDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5fY2xvc2VQb3B1cEJvdW5kID0gdGhpcy5jbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHJlbW92ZVByZWxvYWQoKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlblwiKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlblwiKTtcclxuICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlUmVtb3RlQ2xpY2tDbG9zZShldnQpIHtcclxuICAgIGlmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZUJvdW5kKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICBcIm1vdXNlZG93blwiLFxyXG4gICAgICB0aGlzLl9oYW5kbGVSZW1vdGVDbGlja0Nsb3NlQm91bmRcclxuICAgICk7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5fY2xvc2VQb3B1cEJvdW5kKTtcclxuICB9XHJcblxyXG4gIF9yZW1vdmVFdmVudExpc3RlbmVycygpIHtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlQm91bmQpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXHJcbiAgICAgIFwibW91c2Vkb3duXCIsXHJcbiAgICAgIHRoaXMuX2hhbmRsZVJlbW90ZUNsaWNrQ2xvc2VCb3VuZFxyXG4gICAgKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9jbG9zZVBvcHVwQm91bmQpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXA7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGN0b3IsIGhhbmRsZVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxjdG9yKTtcclxuICAgIHRoaXMuX29uU3VibWl0ID0gaGFuZGxlU3VibWl0O1xyXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5mb3JtX19zdWJtaXQtYnV0dG9uXCJcclxuICAgICk7XHJcbiAgICB0aGlzLmN1cnJlbnRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVN1Ym1pdCA9IChldmVudCkgPT4ge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgIHRoaXMuX29uU3VibWl0KGlucHV0VmFsdWVzKTtcclxuICB9O1xyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBmb3JtRmllbGRJbnB1dHMgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2Zvcm1TZWxlY3Rvci5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2lucHV0XCIpLFxyXG4gICAgXTtcclxuXHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG5cclxuICAgIGZvcm1GaWVsZElucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVTdWJtaXQpO1xyXG4gIH1cclxuXHJcbiAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVTdWJtaXQpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKS5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlSXNTYXZpbmcoaXNTYXZpbmcpIHtcclxuICAgIGlmIChpc1NhdmluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5jdXJyZW50QnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGNhcmRzRGlzcGxheWVkLFxyXG4gIGNvbmZpZ1ZhbGlkYXRlLFxyXG4gIGNvbmZpZ1VzZXIsXHJcbiAgYXV0aFRva2VuLFxyXG4gIGJhc2VVUkwsXHJcbn0gZnJvbSBcIi4uL2NvbnN0YW50cy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BUEkuanNcIjtcclxuXHJcbmNvbnN0IG1vZGFsUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfcHJvZmlsZVwiKTtcclxuY29uc3QgbW9kYWxBZGRDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9hZGQtY2FyZFwiKTtcclxuY29uc3QgbW9kYWxQaWN0dXJlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9wcm9maWxlLXBpY3R1cmVcIik7XHJcbmNvbnN0IG1vZGFsSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX2Rpc3BsYXktaW1hZ2VcIik7XHJcbmNvbnN0IG1vZGFsQ29uZmlybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfY29uZmlybVwiKTtcclxuXHJcbmNvbnN0IGZvcm1Qcm9maWxlRWxlbWVudCA9IG1vZGFsUHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbmNvbnN0IGZvcm1BZGRDYXJkRWxlbWVudCA9IG1vZGFsQWRkQ2FyZC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbmNvbnN0IGZvcm1QaWN0dXJlRWxlbWVudCA9IG1vZGFsUGljdHVyZS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcblxyXG5jb25zdCBwcm9maWxlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZVwiKTtcclxuXHJcbmNvbnN0IGVkaXRCdXR0b24gPSBwcm9maWxlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBhZGRCdXR0b24gPSBwcm9maWxlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmNvbnN0IHBpY3R1cmVCdXR0b24gPSBwcm9maWxlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZVBpY3R1cmUgPSBwcm9maWxlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xyXG5cclxuY29uc3QgZm9ybU5hbWVUZXh0ID0gbW9kYWxQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRfdHlwZV9uYW1lXCIpO1xyXG5jb25zdCBmb3JtQWJvdXRUZXh0ID0gbW9kYWxQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRfdHlwZV9hYm91dFwiKTtcclxuXHJcbmNvbnN0IGNhcmRTZWxlY3RvciA9IFwiI2NhcmRcIjtcclxuXHJcbmxldCB1c2VySWQ7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKGJhc2VVUkwsIGF1dGhUb2tlbik7XHJcblxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKGNyZWF0ZUNhcmQsIGNhcmRzRGlzcGxheWVkKTtcclxuXHJcbmNvbnN0IHVzZXJPYmplY3QgPSBuZXcgVXNlckluZm8oXHJcbiAgY29uZmlnVXNlci5jdXJyZW50TmFtZSxcclxuICBjb25maWdVc2VyLmN1cnJlbnRBYm91dCxcclxuICBjb25maWdVc2VyLnByb2ZpbGVQaWN0dXJlXHJcbik7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKG1vZGFsSW1hZ2UsIGhhbmRsZVBpY3R1cmVTdWJtaXQpO1xyXG5cclxuY29uc3QgZWRpdEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShtb2RhbFByb2ZpbGUsIGhhbmRsZVByb2ZpbGVTdWJtaXQpO1xyXG5jb25zdCBhZGRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0obW9kYWxBZGRDYXJkLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcclxuY29uc3QgcGljdHVyZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShtb2RhbFBpY3R1cmUsIGhhbmRsZVBpY3R1cmVTdWJtaXQpO1xyXG5cclxuY29uc3QgY29uZmlybUZvcm0gPSBuZXcgUG9wdXBXaXRoQ29uZmlybShtb2RhbENvbmZpcm0pO1xyXG5jb25maXJtRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWdWYWxpZGF0ZSwgZm9ybVByb2ZpbGVFbGVtZW50KTtcclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZ1ZhbGlkYXRlLCBmb3JtQWRkQ2FyZEVsZW1lbnQpO1xyXG5jb25zdCBwaWN0dXJlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGNvbmZpZ1ZhbGlkYXRlLFxyXG4gIGZvcm1QaWN0dXJlRWxlbWVudFxyXG4pO1xyXG5cclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxucGljdHVyZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKCkge1xyXG4gIGNvbnN0IHVzZXJJbmZvID0gdXNlck9iamVjdC5nZXRVc2VySW5mbygpO1xyXG4gIGZvcm1OYW1lVGV4dC52YWx1ZSA9IHVzZXJJbmZvLm5hbWU7XHJcbiAgZm9ybUFib3V0VGV4dC52YWx1ZSA9IHVzZXJJbmZvLmFib3V0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBkaXNwbGF5RWRpdCgpIHtcclxuICBmaWxsUHJvZmlsZUZvcm0oKTtcclxuICBlZGl0Rm9ybS5vcGVuKCk7XHJcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRpc3BsYXlBZGQoKSB7XHJcbiAgYWRkRm9ybS5vcGVuKCk7XHJcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGlzcGxheUNoYW5nZUF2YXRhcigpIHtcclxuICBwaWN0dXJlRm9ybS5vcGVuKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVTdWJtaXQoZGF0YSkge1xyXG4gIGVkaXRGb3JtLnRvZ2dsZUlzU2F2aW5nKHRydWUpO1xyXG4gIFByb21pc2UucmVzb2x2ZShhcGkuc2V0VXNlckluZm8oZGF0YSkpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHVzZXJPYmplY3Quc2V0VXNlckluZm8oZGF0YS5uYW1lLCBkYXRhLmFib3V0KTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke2Vyci5zdGF0dXN9YCk7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBlZGl0Rm9ybS50b2dnbGVJc1NhdmluZyhmYWxzZSk7XHJcbiAgICAgIGVkaXRGb3JtLmNsb3NlKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChkYXRhKSB7XHJcbiAgYWRkRm9ybS50b2dnbGVJc1NhdmluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5hZGRDYXJkKGRhdGEpXHJcbiAgICAudGhlbigoY2FyZERhdGEpID0+IHtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRGF0YSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtlcnIuc3RhdHVzfWApO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgYWRkRm9ybS50b2dnbGVJc1NhdmluZyhmYWxzZSk7XHJcbiAgICAgIGFkZEZvcm0uY2xvc2UoKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQaWN0dXJlU3VibWl0KGRhdGEpIHtcclxuICBwaWN0dXJlRm9ybS50b2dnbGVJc1NhdmluZyh0cnVlKTtcclxuICBQcm9taXNlLnJlc29sdmUoYXBpLnNldEF2YXRhcihkYXRhLmF2YXRhcikpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHVzZXJPYmplY3Quc2V0UHJvZmlsZVBpY3R1cmUoZGF0YS5hdmF0YXIpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgocmVycikgPT4ge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke2Vyci5zdGF0dXN9YCk7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwaWN0dXJlRm9ybS50b2dnbGVJc1NhdmluZyhmYWxzZSk7XHJcbiAgICAgIHBpY3R1cmVGb3JtLmNsb3NlKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGlzcGxheUltYWdlKG5hbWUsIGxpbmspIHtcclxuICBpbWFnZVBvcHVwLm9wZW4obmFtZSwgbGluayk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZCkge1xyXG4gIGNvbmZpcm1Gb3JtLm9wZW4oKTtcclxuICBjb25maXJtRm9ybS5zZXRTdWJtaXQoKCkgPT4ge1xyXG4gICAgUHJvbWlzZS5yZXNvbHZlKGFwaS5kZWxldGVDYXJkKGNhcmQuX2lkKSlcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlTG9jYWxDYXJkKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjb25maXJtRm9ybS5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7ZXJyLnN0YXR1c31gKTtcclxuICAgICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRMaWtlKGNhcmQpIHtcclxuICBpZiAoY2FyZC5pc0xpa2VkKCkpIHtcclxuICAgIFByb21pc2UucmVzb2x2ZShhcGkucmVtb3ZlTGlrZShjYXJkLl9pZCkpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IGNhcmQudXBkYXRlTGlrZXMocmVzLmxpa2VzKSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke2Vyci5zdGF0dXN9YCk7XHJcbiAgICAgIH0pO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBQcm9taXNlLnJlc29sdmUoYXBpLmFkZExpa2UoY2FyZC5faWQpKVxyXG4gICAgICAudGhlbigocmVzKSA9PiBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcykpXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtlcnIuc3RhdHVzfWApO1xyXG4gICAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZCkge1xyXG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmQsXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVDYXJkTGlrZSxcclxuICAgIGhhbmRsZURpc3BsYXlJbWFnZSxcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQsXHJcbiAgICB1c2VySWRcclxuICApO1xyXG4gIHJldHVybiBuZXdDYXJkLmdldENhcmRFbGVtZW50KCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldFBhZ2VMaXN0ZW5lcnMoKSB7XHJcbiAgZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZGlzcGxheUVkaXQpO1xyXG4gIGFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZGlzcGxheUFkZCk7XHJcbiAgcGljdHVyZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZGlzcGxheUNoYW5nZUF2YXRhcik7XHJcbn1cclxuXHJcblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcclxuICAudGhlbigoW3VzZXJEYXRhLCBpbml0aWFsRGF0YV0pID0+IHtcclxuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcclxuICAgIHVzZXJPYmplY3Quc2V0UHJvZmlsZVBpY3R1cmUodXNlckRhdGEuYXZhdGFyKTtcclxuICAgIHVzZXJPYmplY3Quc2V0VXNlckluZm8odXNlckRhdGEubmFtZSwgdXNlckRhdGEuYWJvdXQpO1xyXG4gICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoaW5pdGlhbERhdGEpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcblxyXG5zZXRQYWdlTGlzdGVuZXJzKCk7XHJcbiIsImNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoYmFzZVVSTCwgYXV0aFRva2VuKSB7XHJcbiAgICB0aGlzLl9iYXNlVVJMID0gYmFzZVVSTDtcclxuICAgIHRoaXMuX2F1dGhUb2tlbiA9IGF1dGhUb2tlbjtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246IGF1dGhUb2tlbixcclxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgX3Byb2Nlc3NTZXJ2ZXJSZXNwb25zZSA9IChyZXMpID0+IHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfTtcclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVUkx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXBpSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhkYXRhKSB7XHJcbiAgICBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRBdmF0YXIoZGF0YSkge1xyXG4gICAgZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogZGF0YSxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVUkx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgIGxpbms6IGRhdGEubGluayxcclxuICAgICAgICBsaWtlczogZGF0YS5saWtlcyxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS9jYXJkcy8ke2RhdGF9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGRMaWtlKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS9jYXJkcy9saWtlcy8ke2RhdGF9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVMaWtlKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS9jYXJkcy9saWtlcy8ke2RhdGF9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBcGk7XHJcbiIsImNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBjbGFzc1NlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY2FyZHNEaXNwbGF5ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNsYXNzU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoZGF0YSkge1xyXG4gICAgZGF0YS5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgICAgdGhpcy5fY2FyZHNEaXNwbGF5ZWQuYXBwZW5kKGNhcmQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIGNvbnN0IGNhcmQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIHRoaXMuX2NhcmRzRGlzcGxheWVkLnByZXBlbmQoY2FyZCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uO1xyXG4iLCJjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVMaWtlLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGRlbGV0ZVNlcnZlckNhcmQsXHJcbiAgICB1c2VySWRcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuXHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcblxyXG4gICAgdGhpcy5faGFuZGxlTGlrZSA9IGhhbmRsZUxpa2U7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2RlbGV0ZVNlcnZlckNhcmQgPSBkZWxldGVTZXJ2ZXJDYXJkO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBnZXRDYXJkRWxlbWVudCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZFRleHQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICB0aGlzLl9jYXJkTGlrZXMgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZXNcIik7XHJcblxyXG4gICAgdGhpcy5fY2FyZFRleHQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fYWx0O1xyXG4gICAgdGhpcy5fY2FyZExpa2VzLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG5cclxuICAgIHRoaXMuX2hlYXJ0QnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9pbWFnZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuXHJcbiAgICB0aGlzLl9hc3NpZ25DYXJkQnV0dG9ucygpO1xyXG5cclxuICAgIGlmICh0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLnJlbW92ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfYXNzaWduQ2FyZEJ1dHRvbnMoKSB7XHJcbiAgICB0aGlzLl9oZWFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZSh0aGlzKSk7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2RlbGV0ZVNlcnZlckNhcmQodGhpcylcclxuICAgICk7XHJcbiAgICB0aGlzLl9pbWFnZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGlzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZSgobGlrZSkgPT4gdGhpcy5fdXNlcklkID09PSBsaWtlLl9pZCk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVMaWtlcyhsaWtlcykge1xyXG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgfVxyXG5cclxuICBfcmVuZGVyTGlrZXMoKSB7XHJcbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHtcclxuICAgICAgdGhpcy5faGVhcnRCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfbGlrZWRcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oZWFydEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9saWtlZFwiKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9jYXJkTGlrZXMudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVEZWxldGVMb2NhbENhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xyXG4iLCJjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IobmFtZSwgYWJvdXQsIHBpY3R1cmUpIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWUpO1xyXG4gICAgdGhpcy5fYWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGFib3V0KTtcclxuICAgIHRoaXMuX3BpY3R1cmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBpY3R1cmUpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4geyBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LCBhYm91dDogdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKG5hbWUsIGFib3V0KSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gYWJvdXQ7XHJcbiAgfVxyXG5cclxuICBzZXRQcm9maWxlUGljdHVyZShkYXRhKSB7XHJcbiAgICB0aGlzLl9waWN0dXJlLnNyYyA9IGRhdGE7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbztcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fbW9kYWxJbWFnZURlc2NyaXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19pbWFnZS1kZXNjdHJpcHRpb25cIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9tb2RhbEltYWdlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoSW1hZ2U7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoQ29uZmlybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdChpbnB1dCkge1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gaW5wdXQ7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhDb25maXJtO1xyXG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9zZXR0aW5ncyIsIl9mb3JtRWxlbWVudCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRMaXN0IiwiX2J1dHRvbkVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJjbGFzc0xpc3QiLCJhZGQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwicmVtb3ZlQXR0cmlidXRlIiwicmVtb3ZlIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiaW5wdXRFcnJvckNsYXNzIiwidGV4dENvbnRlbnQiLCJlcnJvckNsYXNzIiwiX2hpZGVJbnB1dEVycm9yIiwiX2ZpZWxkc2V0RWxlbWVudCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJzb21lIiwiX2hhbmRsZUlucHV0Q2hhbmdlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiZm9ybUZpZWxkc2V0U2VsZWN0b3IiLCJyZXNldFZhbGlkYXRpb24iLCJjb25maWdWYWxpZGF0ZSIsImZvcm1TZWxlY3RvciIsImJvZHlFbGVtZW50IiwiZG9jdW1lbnQiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9jbG9zZUJ1dHRvbiIsIl9oYW5kbGVFc2NDbG9zZUJvdW5kIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9oYW5kbGVSZW1vdGVDbGlja0Nsb3NlQm91bmQiLCJfaGFuZGxlUmVtb3RlQ2xpY2tDbG9zZSIsIl9jbG9zZVBvcHVwQm91bmQiLCJjbG9zZSIsIm9wZW4iLCJfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMiLCJrZXkiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwIiwicG9wdXBTZWxjdG9yIiwiaGFuZGxlU3VibWl0Iiwic3VwZXIiLCJldmVudCIsImlucHV0VmFsdWVzIiwiX2dldElucHV0VmFsdWVzIiwiX29uU3VibWl0IiwiX2Zvcm1TZWxlY3RvciIsIl9zdWJtaXRCdXR0b24iLCJjdXJyZW50QnV0dG9uVGV4dCIsImZvcm1GaWVsZElucHV0cyIsImlucHV0IiwibmFtZSIsInZhbHVlIiwiX2hhbmRsZVN1Ym1pdCIsInJlc2V0IiwidG9nZ2xlSXNTYXZpbmciLCJpc1NhdmluZyIsIm1vZGFsUHJvZmlsZSIsIm1vZGFsQWRkQ2FyZCIsIm1vZGFsUGljdHVyZSIsIm1vZGFsSW1hZ2UiLCJtb2RhbENvbmZpcm0iLCJmb3JtUHJvZmlsZUVsZW1lbnQiLCJmb3JtQWRkQ2FyZEVsZW1lbnQiLCJmb3JtUGljdHVyZUVsZW1lbnQiLCJwcm9maWxlRWxlbWVudCIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJwaWN0dXJlQnV0dG9uIiwiZm9ybU5hbWVUZXh0IiwiZm9ybUFib3V0VGV4dCIsInVzZXJJZCIsImFwaSIsImJhc2VVUkwiLCJhdXRoVG9rZW4iLCJyZXMiLCJvayIsImpzb24iLCJjb25zb2xlIiwibG9nIiwic3RhdHVzIiwiUHJvbWlzZSIsInJlamVjdCIsIl9iYXNlVVJMIiwiX2F1dGhUb2tlbiIsIl9oZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsInRoZW4iLCJfcHJvY2Vzc1NlcnZlclJlc3BvbnNlIiwiZ2V0VXNlckluZm8iLCJnZXRBcGlJbmZvIiwiYWxsIiwic2V0VXNlckluZm8iLCJkYXRhIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsInNldEF2YXRhciIsImF2YXRhciIsImFkZENhcmQiLCJsaW5rIiwibGlrZXMiLCJkZWxldGVDYXJkIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJjYXJkU2VjdGlvbiIsInJlbmRlcmVyIiwiY2xhc3NTZWxlY3RvciIsIl9yZW5kZXJlciIsIl9jYXJkc0Rpc3BsYXllZCIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImNhcmQiLCJhcHBlbmQiLCJhZGRJdGVtIiwicHJlcGVuZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUxpa2UiLCJoYW5kbGVJbWFnZUNsaWNrIiwiZGVsZXRlU2VydmVyQ2FyZCIsIl9uYW1lIiwiX2xpbmsiLCJfYWx0IiwiX2xpa2VzIiwiX2lkIiwiX293bmVySWQiLCJvd25lciIsIl91c2VySWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUxpa2UiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9kZWxldGVTZXJ2ZXJDYXJkIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsImdldENhcmRFbGVtZW50IiwiX2VsZW1lbnQiLCJfY2FyZEltYWdlIiwiX2NhcmRUZXh0IiwiX2NhcmRMaWtlcyIsInNyYyIsImFsdCIsImxlbmd0aCIsIl9oZWFydEJ1dHRvbiIsIl9kZWxldGVCdXR0b24iLCJfaW1hZ2VCdXR0b24iLCJfYXNzaWduQ2FyZEJ1dHRvbnMiLCJfcmVuZGVyTGlrZXMiLCJpc0xpa2VkIiwibGlrZSIsInVwZGF0ZUxpa2VzIiwiaGFuZGxlRGVsZXRlTG9jYWxDYXJkIiwiaGFuZGxlQ2FyZExpa2UiLCJoYW5kbGVEaXNwbGF5SW1hZ2UiLCJoYW5kbGVEZWxldGVDYXJkIiwidXNlck9iamVjdCIsInBpY3R1cmUiLCJfYWJvdXQiLCJfcGljdHVyZSIsInNldFByb2ZpbGVQaWN0dXJlIiwiaW1hZ2VQb3B1cCIsIl9pbWFnZSIsIl9tb2RhbEltYWdlRGVzY3JpcHRpb24iLCJoYW5kbGVQaWN0dXJlU3VibWl0IiwiZWRpdEZvcm0iLCJQb3B1cFdpdGhGb3JtIiwicmVzb2x2ZSIsImNhdGNoIiwiZXJyIiwiZmluYWxseSIsImFkZEZvcm0iLCJjYXJkRGF0YSIsInBpY3R1cmVGb3JtIiwiY29uZmlybUZvcm0iLCJzZXRFdmVudExpc3RlbmVycyIsInNldFN1Ym1pdCIsImVkaXRGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImFkZEZvcm1WYWxpZGF0b3IiLCJwaWN0dXJlRm9ybVZhbGlkYXRvciIsInJlcnIiLCJ1c2VyRGF0YSIsImluaXRpYWxEYXRhIiwidXNlckluZm8iLCJmaWxsUHJvZmlsZUZvcm0iXSwic291cmNlUm9vdCI6IiJ9