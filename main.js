!function(){"use strict";var e=class{constructor(e,t){this._settings=e,this._formElement=t}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.setAttribute("disabled",!0),this._buttonElement.classList.add(this._settings.inactiveButtonClass)):(this._buttonElement.removeAttribute("disabled"),this._buttonElement.classList.remove(this._settings.inactiveButtonClass))}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._settings.inputErrorClass),s.textContent=t,s.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._fieldsetElement.querySelector(`.${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_handleInputChange(e){this._checkInputValidity(e),this._toggleButtonState()}_setEventListeners(){this._inputList=[...this._fieldsetElement.querySelectorAll(this._settings.inputSelector)],this._buttonElement=this._fieldsetElement.querySelector(this._settings.submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>this._handleInputChange(e)))}))}enableValidation(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._fieldsetElement=this._formElement.querySelector(this._settings.formFieldsetSelector),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}};const t={formSelector:".form",formFieldsetSelector:".form__fieldset",inputSelector:".form__input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"form__submit-button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"};const s=document.querySelector(".body");var r=class{constructor(e){this._popupElement=e,this._closeButton=this._popupElement.querySelector(".modal__close-button"),this._handleEscCloseBound=this._handleEscClose.bind(this),this._handleRemoteClickCloseBound=this._handleRemoteClickClose.bind(this),this._closePopupBound=this.close.bind(this)}open(){s.classList.remove("preload"),this._popupElement.classList.add("modal_open"),this._setEventListeners()}close(){this._popupElement.classList.remove("modal_open"),this._removeEventListeners()}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleRemoteClickClose(e){e.target===e.currentTarget&&this.close()}_setEventListeners(){document.addEventListener("keydown",this._handleEscCloseBound),this._popupElement.addEventListener("mousedown",this._handleRemoteClickCloseBound),this._closeButton.addEventListener("click",this._closePopupBound)}_removeEventListeners(){document.removeEventListener("keydown",this._handleEscCloseBound),this._popupElement.removeEventListener("mousedown",this._handleRemoteClickCloseBound),this._closeButton.removeEventListener("click",this._closePopupBound)}};var i=class extends r{constructor(e,t){var s,r,i;super(e),s=this,i=e=>{e.preventDefault();const t=this._getInputValues();this._onSubmit(t)},(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(r="_handleSubmit"))in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i,this._onSubmit=t,this._formSelector=this._popupElement.querySelector(".form"),this._submitButton=this._popupElement.querySelector(".form__submit-button"),this.currentButtonText=this._submitButton.textContent}_getInputValues(){const e=[...this._formSelector.querySelectorAll(".form__input")],t={};return e.forEach((e=>{t[e.name]=e.value})),t}_setEventListeners(){super._setEventListeners(),this._formSelector.addEventListener("submit",this._handleSubmit)}_removeEventListeners(){super._removeEventListeners(),this._formSelector.removeEventListener("submit",this._handleSubmit)}close(){super.close(),this._popupElement.querySelector(".form").reset()}toggleIsSaving(e){this._submitButton.textContent=e?"Saving...":this.currentButtonText}};const n=document.querySelector(".modal_profile"),o=document.querySelector(".modal_add-card"),a=document.querySelector(".modal_profile-picture"),l=document.querySelector(".modal_display-image"),h=document.querySelector(".modal_confirm"),u=n.querySelector(".form"),c=o.querySelector(".form"),_=a.querySelector(".form"),d=document.querySelector(".profile"),m=d.querySelector(".profile__edit-button"),p=d.querySelector(".profile__add-button"),v=d.querySelector(".profile__image-button"),f=n.querySelector(".form__input_type_name"),g=n.querySelector(".form__input_type_about");let S;const E=new class{constructor(e,t){var s,r,i;s=this,i=e=>e.ok?e.json():(console.log(`Error: ${e.status}`),Promise.reject(`Error: ${e.status}`)),(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(r="_processServerResponse"))in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i,this._baseURL=e,this._authToken=t,this._headers={authorization:t,"Content-Type":"application/json"}}getInitialCards(){return fetch(`${this._baseURL}/cards`,{method:"GET",headers:this._headers}).then(this._processServerResponse)}getUserInfo(){return fetch(`${this._baseURL}/users/me`,{method:"GET",headers:this._headers}).then(this._processServerResponse)}getApiInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()]).then(this._processServerResponse)}setUserInfo(e){return fetch(`${this._baseURL}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._processServerResponse)}setAvatar(e){return fetch(`${this._baseURL}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._processServerResponse)}addCard(e){return fetch(`${this._baseURL}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link,likes:e.likes})}).then(this._processServerResponse)}deleteCard(e){return fetch(`${this._baseURL}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._processServerResponse)}addLike(e){return fetch(`${this._baseURL}/cards/likes/${e}`,{method:"PUT",headers:this._headers}).then(this._processServerResponse)}removeLike(e){return fetch(`${this._baseURL}/cards/likes/${e}`,{method:"DELETE",headers:this._headers}).then(this._processServerResponse)}}("https://around.nomoreparties.co/v1/group-12","cd0a9a45-f29d-487c-ac51-4b9d290460ac"),b=new class{constructor(e,t){this._renderer=e,this._cardsDisplayed=document.querySelector(t)}renderItems(e){e.forEach((e=>{const t=this._renderer(e);this._cardsDisplayed.append(t)}))}addItem(e){const t=this._renderer(e);this._cardsDisplayed.prepend(t)}}((function(e){return new class{constructor(e,t,s,r,i,n){this._name=e.name,this._link=e.link,this._alt=e.name,this._likes=e.likes,this._id=e._id,this._ownerId=e.owner._id,this._userId=n,this._cardSelector=t,this._handleLike=s,this._handleImageClick=r,this._deleteCard=i}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getCardElement(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._cardText=this._element.querySelector(".card__title"),this._cardLikes=this._element.querySelector(".card__likes"),this._cardText.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._alt,this._cardLikes.textContent=this._likes.length,this._heartButton=this._element.querySelector(".card__like-button"),this._deleteButton=this._element.querySelector(".card__delete-button"),this._imageButton=this._element.querySelector(".card__image"),this._assignCardButtons(),this._ownerId!==this._userId&&this._deleteButton.remove(),this._renderLikes(),this._element}_assignCardButtons(){this._heartButton.addEventListener("click",(()=>this._handleLike(this))),this._deleteButton.addEventListener("click",(()=>this._deleteCard(this))),this._imageButton.addEventListener("click",(()=>this._handleImageClick(this._name,this._link)))}isLiked(){return this._likes.some((e=>this._userId===e._id))}updateLikes(e){this._likes=e,this._renderLikes()}_renderLikes(){this.isLiked()?this._heartButton.classList.add("card_liked"):this._heartButton.classList.remove("card_liked"),this._cardLikes.textContent=this._likes.length}handleDeleteLocalCard(){this._element.remove(),this._element=null}}(e,"#card",$,P,T,S).getCardElement()}),".cards"),y=new class{constructor(e,t,s){this._name=document.querySelector(e),this._about=document.querySelector(t),this._picture=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e,t){this._name.textContent=e,this._about.textContent=t}setProfilePicture(e){this._picture.src=e}}(".profile__title",".profile__description",".profile__image"),L=new class extends r{constructor(e){super(e),this._image=this._popupElement.querySelector(".modal__image"),this._modalImageDescription=this._popupElement.querySelector(".modal__image-desctription")}open(e,t){super.open(),this._image.alt=e,this._image.src=t,this._modalImageDescription.textContent=e}}(l,x),k=new i(n,(function(e){k.toggleIsSaving(!0),E.setUserInfo(e).then((()=>{y.setUserInfo(e.name,e.about),k.close()})).catch((e=>{console.log(`Error: ${e.status}`)})).finally((()=>{k.toggleIsSaving(!1)}))})),C=new i(o,(function(e){C.toggleIsSaving(!0),E.addCard(e).then((e=>{b.addItem(e)})).catch((e=>{console.log(`Error: ${e.status}`)})).finally((()=>{C.toggleIsSaving(!1),C.close()}))})),I=new i(a,x),B=new class extends r{constructor(e){super(e),this._formSelector=this._popupElement.querySelector(".form"),this._submitButton=this._popupElement.querySelector(".form__submit-button"),this.currentButtonText=this._submitButton.textContent}setEventListeners(){super._setEventListeners(),this._formSelector.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}setSubmit(e){this._handleSubmit=e}toggleIsSaving(e){this._submitButton.textContent=e?"Saving...":this.currentButtonText}}(h);B.setEventListeners();const q=new e(t,u),w=new e(t,c),R=new e(t,_);function x(e){I.toggleIsSaving(!0),E.setAvatar(e.avatar).then((()=>y.setProfilePicture(e.avatar))).catch((e=>{console.log(`Error: ${e.status}`)})).finally((()=>{I.close(),I.toggleIsSaving(!1)}))}function P(e,t){L.open(e,t)}function T(e){B.open(),B.setSubmit((()=>{B.toggleIsSaving(!0),E.deleteCard(e._id).then((()=>{e.handleDeleteLocalCard(),B.close()})).catch((e=>{console.log(`Error: ${e.status}`)})).finally((()=>{B.toggleIsSaving(!0)}))}))}function $(e){e.isLiked()?E.removeLike(e._id).then((t=>e.updateLikes(t.likes))).catch((e=>{console.log(`Error: ${e.status}`)})):E.addLike(e._id).then((t=>e.updateLikes(t.likes))).catch((e=>{console.log(`Error: ${e.status}`)}))}q.enableValidation(),w.enableValidation(),R.enableValidation(),Promise.all([E.getUserInfo(),E.getInitialCards()]).then((e=>{let[t,s]=e;S=t._id,y.setProfilePicture(t.avatar),y.setUserInfo(t.name,t.about),b.renderItems(s)})).catch((e=>{console.log(e)})),m.addEventListener("click",(function(){!function(){const e=y.getUserInfo();f.value=e.name,g.value=e.about}(),k.open(),q.resetValidation()})),p.addEventListener("click",(function(){C.open(),w.resetValidation()})),v.addEventListener("click",(function(){I.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UTBDLEVBQUtxQyxZQUFZL0UsRUFBSStCLFNBQ25DZ0UsT0FBT0MsSUFDTjdGLFFBQVFDLElBQUssVUFBUzRGLEVBQUkzRixTQUFTLEdBRzNDLENBOUdBbUcsRUFBeUJ0SyxtQkFDekJ3SyxFQUF3QnhLLG1CQUN4QnlLLEVBQTBCekssbUJBZ0kxQm9FLFFBQVFjLElBQUksQ0FBQ3ZCLEVBQUlxQixjQUFlckIsRUFBSWUsb0JBQ2pDSSxNQUFLLElBQTZCLElBQTNCNEYsRUFBVUMsR0FBWSxFQUM1QmpILEVBQVNnSCxFQUFTdkQsSUFDbEIrQixFQUFXSSxrQkFBa0JvQixFQUFTaEYsUUFDdEN3RCxFQUFXL0QsWUFBWXVGLEVBQVNwSSxLQUFNb0ksRUFBU2xGLE9BQy9DUyxFQUFZSyxZQUFZcUUsRUFBWSxJQUVyQ2QsT0FBT0MsSUFDTjdGLFFBQVFDLElBQUk0RixFQUFJLElBYmxCekcsRUFBa0J0RCxpQkFBaUIsU0FuSHJDLFlBTkEsV0FDRSxNQUFNNkssRUFBVzFCLEVBQVdsRSxjQUM1QnhCLEVBQWFqQixNQUFRcUksRUFBU3RJLEtBQzlCbUIsRUFBY2xCLE1BQVFxSSxFQUFTcEYsS0FDakMsQ0FHRXFGLEdBQ0FsQixFQUFnQnhJLE9BQ2hCbUosRUFBeUJsSyxpQkFDM0IsSUFnSEVrRCxFQUFjdkQsaUJBQWlCLFNBOUdqQyxXQUNFaUssRUFBZTdJLE9BQ2ZxSixFQUF3QnBLLGlCQUMxQixJQTRHRW1ELEVBQW1CeEQsaUJBQWlCLFNBMUd0QyxXQUNFbUssRUFBaUIvSSxNQUNuQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb25zdGFudHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvdXRpbHMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy91dGlscy9BUEkuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZmllbGRzZXRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlSW5wdXRDaGFuZ2UoaW5wdXRFbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2ZpZWxkc2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpLFxyXG4gICAgXTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9maWVsZHNldEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT5cclxuICAgICAgICB0aGlzLl9oYW5kbGVJbnB1dENoYW5nZShpbnB1dEVsZW1lbnQpXHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9maWVsZHNldEVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zZXR0aW5ncy5mb3JtRmllbGRzZXRTZWxlY3RvclxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiIsImNvbnN0IGF1dGhUb2tlbiA9IFwiY2QwYTlhNDUtZjI5ZC00ODdjLWFjNTEtNGI5ZDI5MDQ2MGFjXCI7XHJcbmNvbnN0IGJhc2VVUkwgPSBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIjtcclxuXHJcbmNvbnN0IGRhdmlkSW1hZ2UgPSBuZXcgVVJMKFwiLi4vaW1hZ2VzL2RhdmlkLmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpO1xyXG5cclxuY29uc3QgY2FyZHNEaXNwbGF5ZWQgPSBcIi5jYXJkc1wiO1xyXG5cclxuY29uc3QgY29uZmlnVmFsaWRhdGUgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbiAgZm9ybUZpZWxkc2V0U2VsZWN0b3I6IFwiLmZvcm1fX2ZpZWxkc2V0XCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fc3VibWl0LWJ1dHRvbl9pbmFjdGl2ZVwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJmb3JtX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcblxyXG5jb25zdCBjb25maWdDbG9zZSA9IHtcclxuICBjbG9zZUJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIsXHJcbiAgbW9kYWxPdmVybGF5U2VsZWN0b3I6IFwiLm1vZGFsXCIsXHJcbiAgbW9kYWxDb250YWluZXJMaXN0OiBcIi5tb2RhbF9fY29udGFpbmVyXCIsXHJcbn07XHJcblxyXG5jb25zdCBjb25maWdVc2VyID0ge1xyXG4gIHVzZXJNb2RhbDogXCIubW9kYWxfcHJvZmlsZVwiLFxyXG4gIGN1cnJlbnROYW1lOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIGN1cnJlbnRBYm91dDogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuICBuZXdOYW1lOiBcIi5mb3JtX19pbnB1dF90eXBlX25hbWVcIixcclxuICBuZXdBYm91dDogXCIuZm9ybV9faW5wdXRfdHlwZV9hYm91dFwiLFxyXG4gIHByb2ZpbGVQaWN0dXJlOiBcIi5wcm9maWxlX19pbWFnZVwiLFxyXG59O1xyXG5cclxuLypjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJCb3VsZGVyLCBDT1wiLFxyXG4gICAgbGluazogYm91bGRlckltYWdlLFxyXG4gICAgbGlrZXM6IFtdLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJEb2hlbnkgQmVhY2gsIENBXCIsXHJcbiAgICBsaW5rOiBkb2hlbnlJbWFnZSxcclxuICAgIGxpa2VzOiBbXSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiRXVyZWthIFNwcmluZ3MsIEFLXCIsXHJcbiAgICBsaW5rOiBldXJla2FJbWFnZSxcclxuICAgIGxpa2VzOiBbXSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiRm9ydCBMYXVkZXJkYWxlLCBGTFwiLFxyXG4gICAgbGluazogbGF1ZGVyZGFsZUltYWdlLFxyXG4gICAgbGlrZXM6IFtdLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJNZWx2ZXJuIExha2UsIEtTXCIsXHJcbiAgICBsaW5rOiBtZWx2ZXJuSW1hZ2UsXHJcbiAgICBsaWtlczogW10sXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlJveWFsIEdvcmdlLCBDT1wiLFxyXG4gICAgbGluazogcm95YWxJbWFnZSxcclxuICAgIGxpa2VzOiBbXSxcclxuICB9LFxyXG5dOyovXHJcblxyXG5leHBvcnQge1xyXG4gIGNhcmRzRGlzcGxheWVkLFxyXG4gIGNvbmZpZ1ZhbGlkYXRlLFxyXG4gIGNvbmZpZ0Nsb3NlLFxyXG4gIGNvbmZpZ1VzZXIsXHJcbiAgYXV0aFRva2VuLFxyXG4gIGJhc2VVUkwsXHJcbn07XHJcbiIsImNvbnN0IGJvZHlFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ib2R5XCIpO1xyXG5cclxuZnVuY3Rpb24gcmVtb3ZlUHJlbG9hZCgpIHtcclxuICBib2R5RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicHJlbG9hZFwiKTtcclxufVxyXG5cclxuZXhwb3J0IHsgcmVtb3ZlUHJlbG9hZCB9O1xyXG4iLCJpbXBvcnQgeyByZW1vdmVQcmVsb2FkIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gcG9wdXBTZWxlY3RvcjtcclxuXHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCJcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2VCb3VuZCA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9oYW5kbGVSZW1vdGVDbGlja0Nsb3NlQm91bmQgPSB0aGlzLl9oYW5kbGVSZW1vdGVDbGlja0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9jbG9zZVBvcHVwQm91bmQgPSB0aGlzLmNsb3NlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgcmVtb3ZlUHJlbG9hZCgpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuXCIpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuXCIpO1xyXG4gICAgdGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYW5kbGVSZW1vdGVDbGlja0Nsb3NlKGV2dCkge1xyXG4gICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlQm91bmQpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgIFwibW91c2Vkb3duXCIsXHJcbiAgICAgIHRoaXMuX2hhbmRsZVJlbW90ZUNsaWNrQ2xvc2VCb3VuZFxyXG4gICAgKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9jbG9zZVBvcHVwQm91bmQpO1xyXG4gIH1cclxuXHJcbiAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2VCb3VuZCk7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcclxuICAgICAgXCJtb3VzZWRvd25cIixcclxuICAgICAgdGhpcy5faGFuZGxlUmVtb3RlQ2xpY2tDbG9zZUJvdW5kXHJcbiAgICApO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2Nsb3NlUG9wdXBCb3VuZCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cDtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsY3RvciwgaGFuZGxlU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGN0b3IpO1xyXG4gICAgdGhpcy5fb25TdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG5cclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5mb3JtX19zdWJtaXQtYnV0dG9uXCJcclxuICAgICk7XHJcbiAgICB0aGlzLmN1cnJlbnRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVN1Ym1pdCA9IChldmVudCkgPT4ge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgIHRoaXMuX29uU3VibWl0KGlucHV0VmFsdWVzKTtcclxuICB9O1xyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBmb3JtRmllbGRJbnB1dHMgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2Zvcm1TZWxlY3Rvci5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2lucHV0XCIpLFxyXG4gICAgXTtcclxuXHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG5cclxuICAgIGZvcm1GaWVsZElucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVTdWJtaXQpO1xyXG4gIH1cclxuXHJcbiAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVTdWJtaXQpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKS5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlSXNTYXZpbmcoaXNTYXZpbmcpIHtcclxuICAgIGlmIChpc1NhdmluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5jdXJyZW50QnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGNhcmRzRGlzcGxheWVkLFxyXG4gIGNvbmZpZ1ZhbGlkYXRlLFxyXG4gIGNvbmZpZ1VzZXIsXHJcbiAgYXV0aFRva2VuLFxyXG4gIGJhc2VVUkwsXHJcbn0gZnJvbSBcIi4uL2NvbnN0YW50cy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BUEkuanNcIjtcclxuXHJcbmNvbnN0IG1vZGFsUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfcHJvZmlsZVwiKTtcclxuY29uc3QgbW9kYWxBZGRDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9hZGQtY2FyZFwiKTtcclxuY29uc3QgbW9kYWxQaWN0dXJlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9wcm9maWxlLXBpY3R1cmVcIik7XHJcbmNvbnN0IG1vZGFsSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX2Rpc3BsYXktaW1hZ2VcIik7XHJcbmNvbnN0IG1vZGFsQ29uZmlybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfY29uZmlybVwiKTtcclxuXHJcbmNvbnN0IGZvcm1Qcm9maWxlRWxlbWVudCA9IG1vZGFsUHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbmNvbnN0IGZvcm1BZGRDYXJkRWxlbWVudCA9IG1vZGFsQWRkQ2FyZC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbmNvbnN0IGZvcm1QaWN0dXJlRWxlbWVudCA9IG1vZGFsUGljdHVyZS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcblxyXG5jb25zdCBwcm9maWxlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZVwiKTtcclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gcHJvZmlsZUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IHByb2ZpbGVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgY2hhbmdlQXZhdGFyQnV0dG9uID0gcHJvZmlsZUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19pbWFnZS1idXR0b25cIlxyXG4pO1xyXG5cclxuY29uc3QgZm9ybU5hbWVUZXh0ID0gbW9kYWxQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRfdHlwZV9uYW1lXCIpO1xyXG5jb25zdCBmb3JtQWJvdXRUZXh0ID0gbW9kYWxQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRfdHlwZV9hYm91dFwiKTtcclxuXHJcbmNvbnN0IGNhcmRTZWxlY3RvciA9IFwiI2NhcmRcIjtcclxuXHJcbmxldCB1c2VySWQ7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKGJhc2VVUkwsIGF1dGhUb2tlbik7XHJcblxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKGNyZWF0ZUNhcmQsIGNhcmRzRGlzcGxheWVkKTtcclxuXHJcbmNvbnN0IHVzZXJPYmplY3QgPSBuZXcgVXNlckluZm8oXHJcbiAgY29uZmlnVXNlci5jdXJyZW50TmFtZSxcclxuICBjb25maWdVc2VyLmN1cnJlbnRBYm91dCxcclxuICBjb25maWdVc2VyLnByb2ZpbGVQaWN0dXJlXHJcbik7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKG1vZGFsSW1hZ2UsIGhhbmRsZVBpY3R1cmVTdWJtaXQpO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0obW9kYWxQcm9maWxlLCBoYW5kbGVQcm9maWxlU3VibWl0KTtcclxuY29uc3QgYWRkUHJvZmlsZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShtb2RhbEFkZENhcmQsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xyXG5jb25zdCBjaGFuZ2VBdmF0YXJGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0obW9kYWxQaWN0dXJlLCBoYW5kbGVQaWN0dXJlU3VibWl0KTtcclxuXHJcbmNvbnN0IGNvbmZpcm1Gb3JtID0gbmV3IFBvcHVwV2l0aENvbmZpcm0obW9kYWxDb25maXJtKTtcclxuY29uZmlybUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGNvbmZpZ1ZhbGlkYXRlLFxyXG4gIGZvcm1Qcm9maWxlRWxlbWVudFxyXG4pO1xyXG5jb25zdCBhZGRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGNvbmZpZ1ZhbGlkYXRlLFxyXG4gIGZvcm1BZGRDYXJkRWxlbWVudFxyXG4pO1xyXG5jb25zdCBjaGFuZ2VBdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uZmlnVmFsaWRhdGUsXHJcbiAgZm9ybVBpY3R1cmVFbGVtZW50XHJcbik7XHJcblxyXG5lZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hZGRQcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmNoYW5nZUF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKCkge1xyXG4gIGNvbnN0IHVzZXJJbmZvID0gdXNlck9iamVjdC5nZXRVc2VySW5mbygpO1xyXG4gIGZvcm1OYW1lVGV4dC52YWx1ZSA9IHVzZXJJbmZvLm5hbWU7XHJcbiAgZm9ybUFib3V0VGV4dC52YWx1ZSA9IHVzZXJJbmZvLmFib3V0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBkaXNwbGF5RWRpdCgpIHtcclxuICBmaWxsUHJvZmlsZUZvcm0oKTtcclxuICBlZGl0UHJvZmlsZUZvcm0ub3BlbigpO1xyXG4gIGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGlzcGxheUFkZCgpIHtcclxuICBhZGRQcm9maWxlRm9ybS5vcGVuKCk7XHJcbiAgYWRkUHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRpc3BsYXlDaGFuZ2VBdmF0YXIoKSB7XHJcbiAgY2hhbmdlQXZhdGFyRm9ybS5vcGVuKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVTdWJtaXQoZGF0YSkge1xyXG4gIGVkaXRQcm9maWxlRm9ybS50b2dnbGVJc1NhdmluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5zZXRVc2VySW5mbyhkYXRhKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICB1c2VyT2JqZWN0LnNldFVzZXJJbmZvKGRhdGEubmFtZSwgZGF0YS5hYm91dCk7XHJcbiAgICAgIGVkaXRQcm9maWxlRm9ybS5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnIuc3RhdHVzfWApO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgZWRpdFByb2ZpbGVGb3JtLnRvZ2dsZUlzU2F2aW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KGRhdGEpIHtcclxuICBhZGRQcm9maWxlRm9ybS50b2dnbGVJc1NhdmluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5hZGRDYXJkKGRhdGEpXHJcbiAgICAudGhlbigoY2FyZERhdGEpID0+IHtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRGF0YSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vyci5zdGF0dXN9YCk7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBhZGRQcm9maWxlRm9ybS50b2dnbGVJc1NhdmluZyhmYWxzZSk7XHJcbiAgICAgIGFkZFByb2ZpbGVGb3JtLmNsb3NlKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUGljdHVyZVN1Ym1pdChkYXRhKSB7XHJcbiAgY2hhbmdlQXZhdGFyRm9ybS50b2dnbGVJc1NhdmluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5zZXRBdmF0YXIoZGF0YS5hdmF0YXIpXHJcbiAgICAudGhlbigoKSA9PiB1c2VyT2JqZWN0LnNldFByb2ZpbGVQaWN0dXJlKGRhdGEuYXZhdGFyKSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnIuc3RhdHVzfWApO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgY2hhbmdlQXZhdGFyRm9ybS5jbG9zZSgpO1xyXG4gICAgICBjaGFuZ2VBdmF0YXJGb3JtLnRvZ2dsZUlzU2F2aW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEaXNwbGF5SW1hZ2UobmFtZSwgbGluaykge1xyXG4gIGltYWdlUG9wdXAub3BlbihuYW1lLCBsaW5rKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkKSB7XHJcbiAgY29uZmlybUZvcm0ub3BlbigpO1xyXG4gIGNvbmZpcm1Gb3JtLnNldFN1Ym1pdCgoKSA9PiB7XHJcbiAgICBjb25maXJtRm9ybS50b2dnbGVJc1NhdmluZyh0cnVlKTtcclxuICAgIGFwaVxyXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLl9pZClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlTG9jYWxDYXJkKCk7XHJcbiAgICAgICAgY29uZmlybUZvcm0uY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIGNvbmZpcm1Gb3JtLnRvZ2dsZUlzU2F2aW5nKHRydWUpO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZExpa2UoY2FyZCkge1xyXG4gIGlmIChjYXJkLmlzTGlrZWQoKSkge1xyXG4gICAgYXBpXHJcbiAgICAgIC5yZW1vdmVMaWtlKGNhcmQuX2lkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcykpXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vyci5zdGF0dXN9YCk7XHJcbiAgICAgIH0pO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBhcGlcclxuICAgICAgLmFkZExpa2UoY2FyZC5faWQpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IGNhcmQudXBkYXRlTGlrZXMocmVzLmxpa2VzKSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyLnN0YXR1c31gKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmQpIHtcclxuICBjb25zdCBuZXdDYXJkID0gbmV3IENhcmQoXHJcbiAgICBjYXJkLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgaGFuZGxlQ2FyZExpa2UsXHJcbiAgICBoYW5kbGVEaXNwbGF5SW1hZ2UsXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkLFxyXG4gICAgdXNlcklkXHJcbiAgKTtcclxuICByZXR1cm4gbmV3Q2FyZC5nZXRDYXJkRWxlbWVudCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRQYWdlTGlzdGVuZXJzKCkge1xyXG4gIGVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBkaXNwbGF5RWRpdCk7XHJcbiAgYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZGlzcGxheUFkZCk7XHJcbiAgY2hhbmdlQXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBkaXNwbGF5Q2hhbmdlQXZhdGFyKTtcclxufVxyXG5cclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxyXG4gIC50aGVuKChbdXNlckRhdGEsIGluaXRpYWxEYXRhXSkgPT4ge1xyXG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgdXNlck9iamVjdC5zZXRQcm9maWxlUGljdHVyZSh1c2VyRGF0YS5hdmF0YXIpO1xyXG4gICAgdXNlck9iamVjdC5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS5hYm91dCk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcyhpbml0aWFsRGF0YSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9KTtcclxuXHJcbnNldFBhZ2VMaXN0ZW5lcnMoKTtcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihiYXNlVVJMLCBhdXRoVG9rZW4pIHtcclxuICAgIHRoaXMuX2Jhc2VVUkwgPSBiYXNlVVJMO1xyXG4gICAgdGhpcy5fYXV0aFRva2VuID0gYXV0aFRva2VuO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogYXV0aFRva2VuLFxyXG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBfcHJvY2Vzc1NlcnZlclJlc3BvbnNlID0gKHJlcykgPT4ge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9O1xyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVUkx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRBcGlJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKS50aGVuKFxyXG4gICAgICB0aGlzLl9wcm9jZXNzU2VydmVyUmVzcG9uc2VcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0OiBkYXRhLmFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1NlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHNldEF2YXRhcihkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogZGF0YSxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVVJMfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICBsaW5rOiBkYXRhLmxpbmssXHJcbiAgICAgICAgbGlrZXM6IGRhdGEubGlrZXMsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vY2FyZHMvJHtkYXRhfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkTGlrZShkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vY2FyZHMvbGlrZXMvJHtkYXRhfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlTGlrZShkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVSTH0vY2FyZHMvbGlrZXMvJHtkYXRhfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iLCJjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgY2xhc3NTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NhcmRzRGlzcGxheWVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjbGFzc1NlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKGRhdGEpIHtcclxuICAgIGRhdGEuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkID0gdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICAgIHRoaXMuX2NhcmRzRGlzcGxheWVkLmFwcGVuZChjYXJkKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShpdGVtKSB7XHJcbiAgICBjb25zdCBjYXJkID0gdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB0aGlzLl9jYXJkc0Rpc3BsYXllZC5wcmVwZW5kKGNhcmQpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgU2VjdGlvbjtcclxuIiwiY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBkYXRhLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgaGFuZGxlTGlrZSxcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBkZWxldGVDYXJkLFxyXG4gICAgdXNlcklkXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2FsdCA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcblxyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG5cclxuICAgIHRoaXMuX2hhbmRsZUxpa2UgPSBoYW5kbGVMaWtlO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9kZWxldGVDYXJkID0gZGVsZXRlQ2FyZDtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIHJldHVybiBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q2FyZEVsZW1lbnQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRUZXh0ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgdGhpcy5fY2FyZExpa2VzID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VzXCIpO1xyXG5cclxuICAgIHRoaXMuX2NhcmRUZXh0LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX2FsdDtcclxuICAgIHRoaXMuX2NhcmRMaWtlcy50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuXHJcbiAgICB0aGlzLl9oZWFydEJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5faW1hZ2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcblxyXG4gICAgdGhpcy5fYXNzaWduQ2FyZEJ1dHRvbnMoKTtcclxuXHJcbiAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5yZW1vdmUoKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX2Fzc2lnbkNhcmRCdXR0b25zKCkge1xyXG4gICAgdGhpcy5faGVhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUxpa2UodGhpcykpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9kZWxldGVDYXJkKHRoaXMpKTtcclxuICAgIHRoaXMuX2ltYWdlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChsaWtlKSA9PiB0aGlzLl91c2VySWQgPT09IGxpa2UuX2lkKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUxpa2VzKGxpa2VzKSB7XHJcbiAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICB9XHJcblxyXG4gIF9yZW5kZXJMaWtlcygpIHtcclxuICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xyXG4gICAgICB0aGlzLl9oZWFydEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9saWtlZFwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hlYXJ0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX2xpa2VkXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX2NhcmRMaWtlcy50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICB9XHJcblxyXG4gIGhhbmRsZURlbGV0ZUxvY2FsQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7XHJcbiIsImNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3RvcihuYW1lLCBhYm91dCwgcGljdHVyZSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZSk7XHJcbiAgICB0aGlzLl9hYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXQpO1xyXG4gICAgdGhpcy5fcGljdHVyZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocGljdHVyZSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7IG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsIGFib3V0OiB0aGlzLl9hYm91dC50ZXh0Q29udGVudCB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgYWJvdXQpIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICB9XHJcblxyXG4gIHNldFByb2ZpbGVQaWN0dXJlKGRhdGEpIHtcclxuICAgIHRoaXMuX3BpY3R1cmUuc3JjID0gZGF0YTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9tb2RhbEltYWdlRGVzY3JpcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX2ltYWdlLWRlc2N0cmlwdGlvblwiXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX21vZGFsSW1hZ2VEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhDb25maXJtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuXHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIuZm9ybV9fc3VibWl0LWJ1dHRvblwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5jdXJyZW50QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0KGlucHV0KSB7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBpbnB1dDtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUlzU2F2aW5nKGlzU2F2aW5nKSB7XHJcbiAgICBpZiAoaXNTYXZpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuY3VycmVudEJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhDb25maXJtO1xyXG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9zZXR0aW5ncyIsIl9mb3JtRWxlbWVudCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRMaXN0IiwiX2J1dHRvbkVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJjbGFzc0xpc3QiLCJhZGQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwicmVtb3ZlQXR0cmlidXRlIiwicmVtb3ZlIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiaW5wdXRFcnJvckNsYXNzIiwidGV4dENvbnRlbnQiLCJlcnJvckNsYXNzIiwiX2hpZGVJbnB1dEVycm9yIiwiX2ZpZWxkc2V0RWxlbWVudCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJzb21lIiwiX2hhbmRsZUlucHV0Q2hhbmdlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiZm9ybUZpZWxkc2V0U2VsZWN0b3IiLCJyZXNldFZhbGlkYXRpb24iLCJjb25maWdWYWxpZGF0ZSIsImZvcm1TZWxlY3RvciIsImJvZHlFbGVtZW50IiwiZG9jdW1lbnQiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9jbG9zZUJ1dHRvbiIsIl9oYW5kbGVFc2NDbG9zZUJvdW5kIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9oYW5kbGVSZW1vdGVDbGlja0Nsb3NlQm91bmQiLCJfaGFuZGxlUmVtb3RlQ2xpY2tDbG9zZSIsIl9jbG9zZVBvcHVwQm91bmQiLCJjbG9zZSIsIm9wZW4iLCJfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMiLCJrZXkiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwIiwicG9wdXBTZWxjdG9yIiwiaGFuZGxlU3VibWl0Iiwic3VwZXIiLCJldmVudCIsImlucHV0VmFsdWVzIiwiX2dldElucHV0VmFsdWVzIiwiX29uU3VibWl0IiwiX2Zvcm1TZWxlY3RvciIsIl9zdWJtaXRCdXR0b24iLCJjdXJyZW50QnV0dG9uVGV4dCIsImZvcm1GaWVsZElucHV0cyIsImlucHV0IiwibmFtZSIsInZhbHVlIiwiX2hhbmRsZVN1Ym1pdCIsInJlc2V0IiwidG9nZ2xlSXNTYXZpbmciLCJpc1NhdmluZyIsIm1vZGFsUHJvZmlsZSIsIm1vZGFsQWRkQ2FyZCIsIm1vZGFsUGljdHVyZSIsIm1vZGFsSW1hZ2UiLCJtb2RhbENvbmZpcm0iLCJmb3JtUHJvZmlsZUVsZW1lbnQiLCJmb3JtQWRkQ2FyZEVsZW1lbnQiLCJmb3JtUGljdHVyZUVsZW1lbnQiLCJwcm9maWxlRWxlbWVudCIsImVkaXRQcm9maWxlQnV0dG9uIiwiYWRkQ2FyZEJ1dHRvbiIsImNoYW5nZUF2YXRhckJ1dHRvbiIsImZvcm1OYW1lVGV4dCIsImZvcm1BYm91dFRleHQiLCJ1c2VySWQiLCJhcGkiLCJiYXNlVVJMIiwiYXV0aFRva2VuIiwicmVzIiwib2siLCJqc29uIiwiY29uc29sZSIsImxvZyIsInN0YXR1cyIsIlByb21pc2UiLCJyZWplY3QiLCJfYmFzZVVSTCIsIl9hdXRoVG9rZW4iLCJfaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJ0aGVuIiwiX3Byb2Nlc3NTZXJ2ZXJSZXNwb25zZSIsImdldFVzZXJJbmZvIiwiZ2V0QXBpSW5mbyIsImFsbCIsInNldFVzZXJJbmZvIiwiZGF0YSIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJzZXRBdmF0YXIiLCJhdmF0YXIiLCJhZGRDYXJkIiwibGluayIsImxpa2VzIiwiZGVsZXRlQ2FyZCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwiY2FyZFNlY3Rpb24iLCJyZW5kZXJlciIsImNsYXNzU2VsZWN0b3IiLCJfcmVuZGVyZXIiLCJfY2FyZHNEaXNwbGF5ZWQiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJjYXJkIiwiYXBwZW5kIiwiYWRkSXRlbSIsInByZXBlbmQiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVMaWtlIiwiaGFuZGxlSW1hZ2VDbGljayIsIl9uYW1lIiwiX2xpbmsiLCJfYWx0IiwiX2xpa2VzIiwiX2lkIiwiX293bmVySWQiLCJvd25lciIsIl91c2VySWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUxpa2UiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9kZWxldGVDYXJkIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsImdldENhcmRFbGVtZW50IiwiX2VsZW1lbnQiLCJfY2FyZEltYWdlIiwiX2NhcmRUZXh0IiwiX2NhcmRMaWtlcyIsInNyYyIsImFsdCIsImxlbmd0aCIsIl9oZWFydEJ1dHRvbiIsIl9kZWxldGVCdXR0b24iLCJfaW1hZ2VCdXR0b24iLCJfYXNzaWduQ2FyZEJ1dHRvbnMiLCJfcmVuZGVyTGlrZXMiLCJpc0xpa2VkIiwibGlrZSIsInVwZGF0ZUxpa2VzIiwiaGFuZGxlRGVsZXRlTG9jYWxDYXJkIiwiaGFuZGxlQ2FyZExpa2UiLCJoYW5kbGVEaXNwbGF5SW1hZ2UiLCJoYW5kbGVEZWxldGVDYXJkIiwidXNlck9iamVjdCIsInBpY3R1cmUiLCJfYWJvdXQiLCJfcGljdHVyZSIsInNldFByb2ZpbGVQaWN0dXJlIiwiaW1hZ2VQb3B1cCIsIl9pbWFnZSIsIl9tb2RhbEltYWdlRGVzY3JpcHRpb24iLCJoYW5kbGVQaWN0dXJlU3VibWl0IiwiZWRpdFByb2ZpbGVGb3JtIiwiUG9wdXBXaXRoRm9ybSIsImNhdGNoIiwiZXJyIiwiZmluYWxseSIsImFkZFByb2ZpbGVGb3JtIiwiY2FyZERhdGEiLCJjaGFuZ2VBdmF0YXJGb3JtIiwiY29uZmlybUZvcm0iLCJzZXRFdmVudExpc3RlbmVycyIsInNldFN1Ym1pdCIsImVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJhZGRQcm9maWxlRm9ybVZhbGlkYXRvciIsImNoYW5nZUF2YXRhckZvcm1WYWxpZGF0b3IiLCJ1c2VyRGF0YSIsImluaXRpYWxEYXRhIiwidXNlckluZm8iLCJmaWxsUHJvZmlsZUZvcm0iXSwic291cmNlUm9vdCI6IiJ9